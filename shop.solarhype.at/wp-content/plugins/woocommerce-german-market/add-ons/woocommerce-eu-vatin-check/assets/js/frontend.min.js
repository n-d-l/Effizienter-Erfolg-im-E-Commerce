!function(l){var c={_valid:!1,init:function(){"always_optional"!=wcvat_script_vars.display_vat_field&&"always_mandatory"!=wcvat_script_vars.display_vat_field&&c.hide_vatin_field(),l("#billing_vat_field").length&&c.ajax_check_vat_field(),l("#billing_country").length&&c.billing_country_handle(),l("#shipping_country").length&&c.shipping_country_handle()},shipping_country_handle:function(){"shipping"==wcvat_script_vars.tax_based_on?(l("#shipping_country").ready(function(){l("#shipping_country").trigger("change")}),l(document).on("change","#ship-to-different-address-checkbox",function(i){(l(this).is(":checked")?l("#shipping_country"):l("#billing_country")).trigger("change")}),l(document).on("change","#shipping_country",function(i){var t=wcvat_script_vars.display_vat_field;"eu_optional"==t||"eu_mandatory"==t?!wcvat_script_vars.base_country_hide&&1!=wcvat_script_vars.base_country_hide||((wcvat_script_vars.base_country!=l("#shipping_country").val()||wcvat_script_vars.show_for_basecountry_hide_eu_countries)&&""!=l("#shipping_country").val()&&wcvat_script_vars.eu_countries.includes(l("#shipping_country").val())?(l("#billing_vat_field").show(),"eu_mandatory"==t&&(l("#billing_vat_field .optional").hide(),0==l("#billing_vat_field .required").length?l('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):l("#billing_vat_field .required").show()),l("#billing_vat").trigger("blur")):(l("#billing_vat").val("").trigger("blur"),l("#billing_vat_field").hide())):"always_optional"!=t&&"always_mandatory"!=t||(l("#billing_vat_field").show(),"always_mandatory"==t&&(l("#billing_vat_field .optional").hide(),0==l("#billing_vat_field .required").length?l('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):l("#billing_vat_field .required").show()),l("#billing_vat").trigger("blur"))})):l("#billing_country").trigger("change")},billing_country_handle:function(){l("#billing_country").ready(function(){l("#billing_country").trigger("change")}),l(document).on("change","#billing_country",function(i){var t;("billing"==wcvat_script_vars.tax_based_on||"shipping"==wcvat_script_vars.tax_based_on&&l("#ship-to-different-address-checkbox").not(":checked").length||"shipping"==wcvat_script_vars.tax_based_on&&0==l("#ship-to-different-address-checkbox").length)&&("eu_optional"==(t=wcvat_script_vars.display_vat_field)||"eu_mandatory"==t?!wcvat_script_vars.base_country_hide&&1!=wcvat_script_vars.base_country_hide||((wcvat_script_vars.base_country!=l("#billing_country").val()||wcvat_script_vars.show_for_basecountry_hide_eu_countries)&&""!=l("#billing_country").val()&&wcvat_script_vars.eu_countries.includes(l("#billing_country").val())?(l("#billing_vat_field").show(),"eu_mandatory"==t&&(l("#billing_vat_field .optional").hide(),0==l("#billing_vat_field .required").length?l('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):l("#billing_vat_field .required").show()),l("#billing_vat").trigger("blur")):(l("#billing_vat").val("").trigger("blur"),l("#billing_vat_field").hide())):"always_optional"!=t&&"always_mandatory"!=t||(l("#billing_vat_field").show(),"always_mandatory"==t&&(l("#billing_vat_field .optional").hide(),0==l("#billing_vat_field .required").length?l('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):l("#billing_vat_field .required").show()),l("#billing_vat").trigger("blur")))})},hide_vatin_field:function(){},ajax_check_vat_field:function(){var n=!1;l("input#billing_vat").ready(function(){""!=l("input#billing_vat").val()&&l("input#billing_vat").trigger("blur")}),l(document).on("blur","input#billing_vat",function(i){var t=wcvat_script_vars.display_vat_field;if(!0===n)return!1;if(""==l(this).val())return c.clean_up_badges(),l("body").trigger("update_checkout"),!1;n=!0,jQuery("#place_order").length&&jQuery("#place_order").prop("disabled",!0);var e=l(this).val();let a=l(this),r="",_=!1;if(r=("shipping"==wcvat_script_vars.tax_based_on&&l("#ship-to-different-address-checkbox").is(":checked")?l("#shipping_country"):l("#billing_country")).val(),!wcvat_script_vars.eu_countries.includes(r))return n=!1,c.clean_up_badges(),jQuery("#place_order").length&&jQuery("#place_order").prop("disabled",!1),!1;("always_mandatory"==t||"eu_mandatory"==t&&wcvat_script_vars.base_country!=r&&wcvat_script_vars.eu_countries.includes(r))&&(_=!0),c.clean_up_badges(),a.after(wcvat_script_vars.spinner);t={action:"wcvat_check_vat",vat:e,country:r,required:_,tax_based_on:wcvat_script_vars.tax_based_on};l.ajax({data:t,url:wcvat_script_vars.ajaxurl,async:!0,dataType:"json"}).always(function(){c.clean_up_badges()}).done(function(i){i&&(!1===i.success?""!=e&&(a.addClass("error"),a.after(wcvat_script_vars.error_badge)):(l(".error-badge").remove(),a.removeClass("error"),a.after(wcvat_script_vars.correct_badge),c._valid=!0))}).always(function(){n=!1,wcvat_script_vars.trigger_update_checkout&&l("body").trigger("update_checkout"),jQuery("#place_order").length&&jQuery("#place_order").prop("disabled",!1)})})},clean_up_badges:function(){l(".error-badge").remove(),l(".spinner-badge").remove(),l(".correct-badge").remove(),l(".spinner-badge").remove()}};l(document).ready(c.init)}(jQuery);